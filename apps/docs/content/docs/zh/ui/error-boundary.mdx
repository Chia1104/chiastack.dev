---
title: Error Boundary
description: React 錯誤邊界元件，用於捕獲和處理元件樹中的錯誤
---

錯誤邊界元件，用於捕獲和處理 React 元件樹中的錯誤，提供優雅的錯誤處理和恢復機制。

## 安裝

<Tabs items={['npm', 'pnpm', 'yarn', 'bun']}>
  <Tab value="npm">
    ```bash
    npm install @chiastack/ui
    ```
  </Tab>
  <Tab value="pnpm">
    ```bash
    pnpm add @chiastack/ui
    ```
  </Tab>
  <Tab value="yarn">
    ```bash
    yarn add @chiastack/ui
    ```
  </Tab>
  <Tab value="bun">
    ```bash
    bun add @chiastack/ui
    ```
  </Tab>
</Tabs>

## 基本用法

```tsx
import { ErrorBoundary } from '@chiastack/ui/error-boundary';

function App() {
  return (
    <ErrorBoundary
      fallback={({ error, reset }) => (
        <div>
          <h2>發生錯誤</h2>
          <p>{error?.message}</p>
          <button onClick={reset}>重試</button>
        </div>
      )}
    >
      <YourComponent />
    </ErrorBoundary>
  );
}
```

## Props

- `children`: React.ReactNode - 子元件
- `className?: string` - 自訂 CSS 類名
- `fallback?: (({ error, reset }) => React.ReactNode) | React.ReactNode` - 錯誤時顯示的 UI
- `onError?: (error: TError, errorInfo: React.ErrorInfo) => void` - 錯誤捕獲回調
- `handleRetry?: ({ error, reset }) => void` - 重試處理函數

## 進階用法

### 自訂錯誤處理

```tsx
import { ErrorBoundary } from '@chiastack/ui/error-boundary';

function App() {
  return (
    <ErrorBoundary
      fallback={({ error, reset }) => (
        <div className="error-container">
          <h2>發生錯誤</h2>
          <p>{error?.message}</p>
          <button onClick={reset}>重試</button>
        </div>
      )}
      onError={(error, errorInfo) => {
        // 記錄錯誤到錯誤追蹤服務
        console.error('Error caught:', error, errorInfo);
        // 可以發送到 Sentry、LogRocket 等服務
      }}
      handleRetry={({ error, reset }) => {
        console.log('Retrying after error:', error);
        // 執行重試前的清理工作
        reset();
      }}
    >
      <YourComponent />
    </ErrorBoundary>
  );
}
```

### 使用函數式 Fallback

```tsx
import { ErrorBoundary } from '@chiastack/ui/error-boundary';

function App() {
  return (
    <ErrorBoundary
      fallback={({ error, reset }) => {
        if (error?.message.includes('Network')) {
          return (
            <div>
              <h2>網路錯誤</h2>
              <p>請檢查您的網路連線</p>
              <button onClick={reset}>重試</button>
            </div>
          );
        }
        return (
          <div>
            <h2>發生未知錯誤</h2>
            <p>{error?.message}</p>
            <button onClick={reset}>重試</button>
          </div>
        );
      }}
    >
      <YourComponent />
    </ErrorBoundary>
  );
}
```

### 使用靜態 Fallback

```tsx
import { ErrorBoundary } from '@chiastack/ui/error-boundary';

function App() {
  return (
    <ErrorBoundary fallback={<div>發生錯誤，請重新整理頁面</div>}>
      <YourComponent />
    </ErrorBoundary>
  );
}
```

## 完整範例

```tsx
import { ErrorBoundary } from '@chiastack/ui/error-boundary';
import { Chart } from '@chiastack/ui/trading-chart/chart';

function TradingApp() {
  return (
    <ErrorBoundary
      fallback={({ error, reset }) => (
        <div className="error-boundary">
          <h2>圖表載入失敗</h2>
          <p>錯誤訊息：{error?.message}</p>
          <button onClick={reset}>重新載入圖表</button>
        </div>
      )}
      onError={(error, errorInfo) => {
        // 記錄錯誤
        console.error('Chart error:', error, errorInfo);
      }}
    >
      <Chart>
        {/* Chart components */}
      </Chart>
    </ErrorBoundary>
  );
}
```

